"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[341],{50666:function(ut,N,n){n.r(N);var ce=n(64599),de=n.n(ce),fe=n(5574),u=n.n(fe),r=n(67294),O=n(34041),me=n(87600),A=n(27310),S=n(2453),z=n(45416),F=n(34586),B=n(71577),ve=n(46004),Ee=n(74330),he=n(40110),ge=n(23430),Pe=n(27484),E=n.n(Pe),$=n(2618),De=n(43485),pe=n(52728),st=n(24078),Le=n(84226),a=n(85893),R=O.Z.Option,lt=me.Z.Text,ot=A.default.RangePicker,Me=function(){var Z,Oe=(0,r.useState)([]),k=u()(Oe,2),Se=k[0],j=k[1],xe=(0,r.useState)(""),G=u()(xe,2),h=G[0],X=G[1],Ce=(0,r.useState)([]),J=u()(Ce,2),g=J[0],Te=J[1],Ae=(0,r.useState)([]),Q=u()(Ae,2),V=Q[0],Fe=Q[1],Be=(0,r.useState)(""),q=u()(Be,2),x=q[0],Re=q[1],Ze=(0,r.useState)(""),ee=u()(Ze,2),P=ee[0],I=ee[1],je=(0,r.useState)(E()().subtract(30,"minutes")),te=u()(je,2),y=te[0],Ie=te[1],ye=(0,r.useState)(E()()),re=u()(ye,2),b=re[0],be=re[1],Ue=(0,r.useState)([]),ne=u()(Ue,2),U=ne[0],We=ne[1],Ke=(0,r.useState)(["ERROR"]),ae=u()(Ke,2),W=ae[0],Ye=ae[1],He=(0,r.useState)(E()().subtract(30,"minutes")),ie=u()(He,2),D=ie[0],we=ie[1],Ne=(0,r.useState)(E()()),ue=u()(Ne,2),p=ue[0],ze=ue[1],$e=(0,r.useState)([]),se=u()($e,2),f=se[0],ke=se[1],Ge=(0,r.useState)(["ERROR"]),le=u()(Ge,2),m=le[0],Xe=le[1],Je=(0,r.useState)(!1),oe=u()(Je,2),Qe=oe[0],C=oe[1],T=(0,r.useRef)(null),d=(0,r.useRef)(null),L=(0,r.useRef)(null),Ve=(0,Le.useModel)("@@initialState"),K=Ve.initialState,i=(K==null||(Z=K.settings)===null||Z===void 0?void 0:Z.isDark)||!1;(0,r.useEffect)(function(){(0,$.xA)().then(function(e){if(e&&Array.isArray(e.files)){if(j(e.files),e.files.length>0){var t=e.files[e.files.length-1];X(t)}}else j([]),S.ZP.error((e==null?void 0:e.error)||"\u670D\u52A1\u5668\u8FD4\u56DE\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E")}).catch(function(e){j([]),S.ZP.error("\u83B7\u53D6\u6587\u4EF6\u5217\u8868\u5931\u8D25: "+e.message)})},[]),(0,r.useEffect)(function(){h&&_e()},[h]),(0,r.useEffect)(function(){if(T.current){d.current=new De.o({rows:1e4,cols:120,cursorBlink:!0,scrollback:1e6,theme:{background:i?"#1e1e1e":"#fbfbfb",foreground:i?"#d4d4d4":"#000",selectionBackground:i?"#333":"#ccc",cursor:i?"#eee":"#111",red:i?"#ff6f6f":"#ee1111",green:i?"#4cab4c":"#1e9400",yellow:i?"#c3c323":"#e59900"}}),L.current=new pe.X,d.current.loadAddon(L.current),d.current.open(T.current),L.current.fit();var e=function(){L.current&&L.current.fit()};return window.addEventListener("resize",e),function(){var t;window.removeEventListener("resize",e),(t=d.current)===null||t===void 0||t.dispose()}}},[T]),(0,r.useEffect)(function(){d.current&&(d.current.options.theme={background:i?"#1e1e1e":"#fbfbfb",foreground:i?"#d4d4d4":"#000",selectionBackground:i?"#333":"#ccc",cursor:i?"#eee":"#111",red:i?"#ff6f6f":"#ee1111",green:i?"#4cab4c":"#1e9400",yellow:i?"#c3c323":"#e59900"})},[i]);var qe=function(t){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.current&&(o&&d.current.clear(),t.forEach(function(c,_){var s,l="";switch(c.level){case"ERROR":l="\x1B[31m";break;case"WARNING":l="\x1B[33m";break;case"INFO":l="\x1B[32m";break;default:l=i?"\x1B[37m":"\x1B[30m"}var v="".concat(l).concat(c.timestamp," ").concat(c.app," ").concat(c.level," ").concat(c.message,"\x1B[0m");(s=d.current)===null||s===void 0||s.write(v+`\r
\r
`)}))},et=function(t){if(!t||typeof t!="string")return[];var o=t.split(`
`).filter(function(w){return w.trim()!==""}),c=[],_=null,s=de()(o),l;try{for(s.s();!(l=s.n()).done;){var v=l.value,M=v.split(" - ");M.length>=4?(_&&c.push(_),_={timestamp:M[0]||"",app:M[1]||"",level:M[2]||"",message:M.slice(3).join(" - ")||""}):_?_.message+=`
`+v:v.trim()!==""&&(_={timestamp:"",app:"",level:"",message:v})}}catch(w){s.e(w)}finally{s.f()}return _&&c.push(_),c},_e=function(){h&&(C(!0),(0,$.Bl)({file:h}).then(function(t){if(t&&typeof t=="string"){var o=et(t);Te(o)}else S.ZP.error((t==null?void 0:t.error)||"\u670D\u52A1\u5668\u8FD4\u56DE\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E")}).catch(function(t){S.ZP.error("\u83B7\u53D6\u65E5\u5FD7\u5185\u5BB9\u5931\u8D25: "+t.message)}).finally(function(){C(!1)}))},Y=(0,r.useMemo)(function(){var e=g;return D&&p&&(e=e.filter(function(t){var o=E()(t.timestamp,"YYYY-MM-DD HH:mm:ss");return o.isSameOrAfter(D)&&o.isSameOrBefore(p)})),f&&f.length>0&&(e=e.filter(function(t){return f.includes(t.app)})),m&&m.length>0&&(e=e.filter(function(t){return m.includes(t.level)})),e},[g,D,p,f,m]),H=(0,r.useMemo)(function(){return P?Y.filter(function(e){return e.message.includes(P)}):Y},[Y,P]);(0,r.useEffect)(function(){Fe(H),qe(H,!0)},[H]);var tt=function(){C(!0),setTimeout(function(){we(y),ze(b),ke(U),Xe(W),I(x),C(!1)},500)};(0,r.useEffect)(function(){g.length>0&&tt()},[y,b,U,W]);var rt=Array.from(new Set(g.map(function(e){return e.app}))),nt=Array.from(new Set(g.map(function(e){return e.level}))),at=function(){var t=it(),o=V.map(function(l){return"".concat(l.timestamp," ").concat(l.app," ").concat(l.level," ").concat(l.message)}).join(`

`),c=new Blob([o],{type:"text/plain;charset=utf-8"}),_=URL.createObjectURL(c),s=document.createElement("a");s.href=_,s.download="".concat(t,".log"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(_)},it=function(){var t="";if(D&&(t+="_".concat(D.format("YYYYMMDD_HHmmss"))),p&&(t+="_".concat(p.format("YYYYMMDD_HHmmss"))),f&&f.length>0&&(t+="_".concat(f.join("_"))),m&&m.length>0&&(t+="_".concat(m.join("_"))),P){var o=P.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g,"_");t+="_search_".concat(o)}return t=t.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g,"_"),t};return(0,a.jsx)("div",{children:(0,a.jsx)(z.Z,{children:(0,a.jsxs)(F.Z,{direction:"vertical",style:{width:"100%",marginTop:"20px"},children:[(0,a.jsxs)(F.Z,{wrap:!0,children:[(0,a.jsx)(O.Z,{placeholder:"\u9009\u62E9\u65E5\u5FD7\u6587\u4EF6",style:{width:200},onChange:function(t){return X(t)},value:h,children:(Se||[]).map(function(e){return(0,a.jsx)(R,{value:e,children:e},e)})}),(0,a.jsx)(B.ZP,{onClick:_e,type:"primary",children:"\u5237\u65B0\u65E5\u5FD7"})]}),(0,a.jsxs)(F.Z,{wrap:!0,children:[(0,a.jsx)(A.default,{showTime:{format:"HH:mm:ss"},placeholder:"\u5F00\u59CB\u65F6\u95F4",style:{width:200},value:y,onChange:function(t){return Ie(t)},format:"YYYY-MM-DD HH:mm:ss"}),(0,a.jsx)(A.default,{showTime:{format:"HH:mm:ss"},placeholder:"\u7ED3\u675F\u65F6\u95F4",style:{width:200},value:b,onChange:function(t){return be(t)},format:"YYYY-MM-DD HH:mm:ss"}),(0,a.jsx)(O.Z,{mode:"multiple",placeholder:"\u6A21\u5757\u7B5B\u9009",style:{width:200},value:U,onChange:function(t){return We(t)},children:(rt||[]).map(function(e){return(0,a.jsx)(R,{value:e,children:e},e)})}),(0,a.jsx)(O.Z,{mode:"multiple",placeholder:"\u65E5\u5FD7\u7B49\u7EA7\u7B5B\u9009",style:{width:200},value:W,onChange:function(t){return Ye(t)},children:(nt||[]).map(function(e){return(0,a.jsx)(R,{value:e,children:e},e)})}),(0,a.jsx)(ve.Z,{placeholder:"\u641C\u7D22\u65E5\u5FD7\u5185\u5BB9...",style:{width:200},prefix:(0,a.jsx)(he.Z,{}),value:x,onChange:function(t){return Re(t.target.value)},onPressEnter:function(){return I(x)}}),(0,a.jsx)(B.ZP,{style:{width:60},onClick:function(){return I(x)},type:"primary",children:"\u641C\u7D22"}),(0,a.jsx)(B.ZP,{style:{width:130},onClick:at,icon:(0,a.jsx)(ge.Z,{}),children:"\u5BFC\u51FA\u5F53\u524D\u65E5\u5FD7"})]}),(0,a.jsx)(Ee.Z,{spinning:Qe,delay:200,children:(0,a.jsx)(z.Z,{title:"\u65E5\u5FD7\u5185\u5BB9 (".concat(V.length," \u6761\u8BB0\u5F55)"),children:(0,a.jsx)("div",{className:"terminal-container",style:{width:"100%",height:"600px",overflow:"auto",position:"relative"},children:(0,a.jsx)("div",{ref:T,style:{width:"100%",height:"600px",backgroundColor:i?"#1e1e1e":"#ffffff",padding:"-5px",overflow:"hidden"}})})})})]})},"0")})};N.default=Me}}]);
